<!DOCTYPE html>
<html manifest="appcache.manifest">
<head>
    <title>HTML5 Offline App</title>
    <link rel="stylesheet" href="offlineapp.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>
<body>
    <div class="table-view">
        <table id="videosTable"><h1>Prime Movies with IMDB Rating</h1>
            <tr>
                <th class="movie">Movie</th>
                <th class="year">Year</th>
                <th class="rating">IMDB Rating</th>
            </tr>
        </table>

        <script>
            // Find a <table> element with id="videosTable":
            var tableElem = document.getElementById("videosTable");

            // load from php
            var jArray;
            $.ajax({
                //url: './phptojs.php',
                url: 'http://imdbprime-snah.rhcloud.com/phptojs.php',
                success: function(data) {
                    jArray = JSON.parse(data);

                    function compare(a, b){
                        // ascending
                            // a > b
                            var b_FIRST_asc = 1;
                            // b > a
                            var a_FIRST_asc = -1;

                        // descending
                            // a > b
                            var a_FIRST_desc = -1;
                            // b > a
                            var b_FIRST_desc= 1;

                        var EQUAL = 0;

                        // init with equal
                        let comparison = EQUAL;

                        // 2017,x ? 2010,y
                        //=======================
                        if ((a[1] > b[1]) && (a[2] > b[2])) {
                            comparison = a_FIRST_desc;
                        }else if ((a[1] > b[1]) && (a[2] < b[2])) {
                            comparison = a_FIRST_desc;
                        }else if ((a[1] > b[1]) && (a[2] == b[2])) {
                            comparison = a_FIRST_desc;
                        }

                        // 2009,x ? 2012,y
                        //=======================
                        else if ((a[1] < b[1]) && (a[2] > b[2])) {
                            comparison = b_FIRST_desc;
                            // 2017,8.0 > 2010,8.7
                        }else if ((a[1] < b[1]) && (a[2] < b[2])) {
                            comparison = b_FIRST_desc;
                            // 2017,8.0 > 2010,8.0
                        }else if ((a[1] < b[1]) && (a[2] == b[2])) {
                            comparison = b_FIRST_desc;
                        }

                        // 2009,x ? 2009,y
                        //=======================
                        else if ((a[1] == b[1]) && (a[2] > b[2])) {
                            comparison = a_FIRST_desc;
                            // 2017,8.0 > 2010,8.7
                        }else if ((a[1] == b[1]) && (a[2] < b[2])) {
                            comparison = b_FIRST_desc;
                            // 2017,8.0 > 2010,8.0
                        }else if ((a[1] == b[1]) && (a[2] == b[2])) {
                            comparison = EQUAL;
                        }

                        return comparison;
                    }

                    jArray.sort(compare);

                    for (i = 0; i < jArray.length; i++) {
                        // Create an empty <tr> element and add it to the 1st position of the table:
                        var row = tableElem.insertRow(i + 1);

                        // Insert new cells (<td> elements) at the 1st and 2nd position of the "new" <tr> element:
                        var cell1 = row.insertCell(0);
                        var cell2 = row.insertCell(1);
                        var cell3 = row.insertCell(2);

                        // Add some text to the new cells:
                        cell1.innerHTML = '<a target="_blank" href=' + jArray[i][3] + '>' + jArray[i][0] + '</a>';
                        cell2.innerHTML = jArray[i][1];
                        cell3.innerHTML = jArray[i][2];
                    }
                }
            });
        </script>

    </div>
</body>
</html>